# 遥控器操作指南

本文档说明了百度网盘TV播放器应用的遥控器支持情况。

## 概述

应用已全面支持遥控器方向键（D-pad）导航和选择操作，包括：
- ✅ 首页（主界面）
- ✅ 播放页面
- ✅ 文件浏览页面
- ✅ 设置页面

## 遥控器按键说明

### 基本按键
- **方向键（上/下/左/右）**: 在可聚焦元素之间导航
- **确认键（OK/Center）**: 点击当前聚焦的元素
- **返回键（Back）**: 返回上一页面或退出

## 各页面操作说明

### 1. 首页（MainFragment）

#### 可聚焦元素
- 播放列表卡片（横向滚动列表）
- "浏览文件" 按钮
- "设置" 按钮

#### 默认焦点行为
- **有播放列表时**: 自动聚焦到第一个播放列表卡片
- **无播放列表时**: 自动聚焦到"浏览文件"按钮

#### 焦点效果
- 聚焦时：卡片或按钮会显示明显的蓝色边框（5dp宽）
- 同时有轻微的缩放动画（1.05倍）
- 聚焦元素会有阴影提升效果

#### 操作流程
1. 使用**左/右方向键**在播放列表之间切换
2. 使用**下方向键**从播放列表移动到快捷操作按钮
3. 使用**左/右方向键**在"浏览文件"和"设置"按钮之间切换
4. 按**确认键**打开选中的播放列表或执行按钮功能

### 2. 文件浏览页面（FileBrowserFragment）

#### 可聚焦元素
- 文件/文件夹列表项（垂直滚动）
- "递归加载"按钮
- "排序"按钮
- "播放当前列表"按钮

#### 默认焦点行为
- 页面加载完成后，自动聚焦到文件列表的第一项

#### 焦点效果
- 聚焦的文件项会显示蓝色边框和轻微缩放
- 焦点在列表项上时，CardView会高亮

#### 操作流程
1. 使用**上/下方向键**在文件列表中导航
2. 使用**右方向键**移动到顶部按钮区域
3. 使用**左/右方向键**在顶部按钮间切换
4. 在文件夹上按**确认键**进入文件夹
5. 在文件上按**确认键**选择文件（多选模式）或播放文件

### 3. 播放页面（PlaybackActivity）

#### 可聚焦元素
- 播放/暂停按钮
- 上一张按钮
- 下一张按钮
- 播放模式按钮
- 图片特效按钮

#### 默认焦点行为
- 进入播放页面时，自动聚焦到"播放/暂停"按钮

#### 焦点效果
- 聚焦的按钮会有明显的视觉突出（缩放和边框）
- 控制栏在显示时，焦点会停留在按钮上

#### 操作流程
1. 按**确认键**显示/隐藏控制栏
2. 控制栏显示时，使用**左/右方向键**在按钮间切换
3. 按**确认键**执行选中按钮的功能
4. 控制栏会在3秒无操作后自动隐藏

#### 按键映射
- **方向键左**: 上一张图片（控制栏隐藏时）
- **方向键右**: 下一张图片（控制栏隐藏时）
- **确认键**: 显示/隐藏控制栏
- **播放/暂停键**: 开始/暂停自动播放

### 4. 设置页面（SettingsActivity）

#### 可聚焦元素
- 图片展示特效选项（9个单选按钮）
- 图片展示时长滑动条
- 播放顺序选项（4个单选按钮）
- 显示拍摄地点开关
- 退出登录按钮

#### 默认焦点行为
- 进入设置页面时，自动聚焦到第一个可交互元素

#### 焦点效果
- 聚焦的控件会有轻微放大效果（1.1倍）
- 聚焦元素所在的设置组会有背景高亮

#### 操作流程
1. 使用**上/下方向键**在不同设置组之间导航
2. 使用**左/右方向键**在同一组内的选项间切换（如单选按钮）
3. 按**确认键**选择选项或切换开关
4. 在滑动条上使用**左/右方向键**调整数值

## 焦点视觉设计

### 焦点边框
- 颜色：`#2196F3`（蓝色）
- 宽度：5dp（列表卡片）、3dp（按钮）
- 圆角：与元素本身的圆角一致

### 焦点动画
- **缩放动画**: 
  - 列表项：1.0 → 1.05（150ms）
  - 按钮：1.0 → 1.1（150ms）
- **淡入淡出**: 边框和阴影平滑过渡

### 焦点传播
- 容器使用 `android:addStatesFromChildren="true"` 
- 子元素获得焦点时，容器背景也会高亮

## 技术实现细节

### 布局层面
- 所有交互元素设置 `android:focusable="true"`
- 列表容器设置 `android:descendantFocusability="afterDescendants"`
- 使用 `android:stateListAnimator` 实现焦点动画

### 代码层面
- 监听列表数据变化，自动设置默认焦点
- 使用 `View.post()` 确保布局完成后再请求焦点
- 播放页面处理 `onKeyDown` 事件，支持方向键切换图片

### 样式资源
- `@drawable/card_selector.xml`: 卡片焦点选择器
- `@drawable/selector_item_background.xml`: 列表项背景选择器
- `@animator/focus_zoom.xml`: 焦点缩放动画（1.05倍）
- `@animator/focus_scale.xml`: 焦点缩放动画（1.1倍）

## 最佳实践建议

### 用户体验
1. **焦点可见性**: 所有焦点状态都有明显的视觉反馈
2. **焦点记忆**: 页面返回时，焦点会恢复到合理位置
3. **逻辑导航**: 焦点移动遵循屏幕布局的逻辑顺序
4. **快捷操作**: 播放页面支持隐藏控制栏时的直接按键操作

### 开发建议
1. 新增可交互元素时，务必设置 `focusable="true"`
2. 为焦点状态提供明显的视觉反馈
3. 测试各种焦点导航路径，确保无死角
4. 考虑不同屏幕尺寸下的焦点效果

## 已知限制

1. **ScrollView 中的焦点**: 在 SettingsActivity 中，需要手动滚动才能看到屏幕外的元素
2. **列表记忆**: RecyclerView 的焦点记忆需要手动管理，目前采用默认聚焦第一项的策略

## 测试建议

### 功能测试
- [ ] 测试各页面的默认焦点是否正确
- [ ] 测试方向键导航是否流畅
- [ ] 测试确认键是否正确触发操作
- [ ] 测试返回键是否正确工作

### 视觉测试
- [ ] 确认焦点边框在所有元素上都清晰可见
- [ ] 确认焦点动画流畅自然
- [ ] 确认高分辨率屏幕上的焦点效果

### 边界测试
- [ ] 空列表时的焦点行为
- [ ] 单项列表时的焦点行为
- [ ] 快速连续按键时的响应
- [ ] 长列表滚动时的焦点保持

## 更新日志

### 2026-02-03
- ✅ 实现首页播放列表卡片的遥控器支持
- ✅ 实现文件浏览页面的遥控器支持
- ✅ 实现播放页面的遥控器支持和按键映射
- ✅ 实现设置页面的遥控器支持
- ✅ 优化所有页面的焦点视觉效果
- ✅ 添加默认焦点逻辑
- ✅ 创建统一的焦点样式资源

---

**注意**: 此应用完全支持遥控器操作，无需触摸屏即可完成所有功能。